--- 
layout: post
title: SpinnerSimpleDateModel
date: "2011-01-14T02:55:00.000-03:00"
author: William Mora
tags: 
permalink: /2011/01/spinnersimpledatemodel.html
---

Here is the code for a <code>JSpinnerModel</code> that handles <code>Date</code> objects in simple format (e.g. 'dd/MM/yyyy'). It extends a <code>SpinnerDateModel</code> so most of the code is based on that class. This class assumes that values are separated by a slash (/). The reason why I created this was based on a client's requirement where I could only display the date in simple format and select the calendar using a <code>JSpinner</code>: <pre>/**<br /> * A SpinnerSimpleDateModel for sequences of formatted Dates.<br /> * in simple format(e.g. "dd/MM/yyyy")<br /> *<br /> * @author William Mora<br /> * @version 1.0<br /> */<br />public class SpinnerSimpleDateModel extends SpinnerDateModel {<br /><br />    private Comparable start, end;<br />    private Date value;<br />    private int calendarField;<br />    private SimpleDateFormat dateFormat;<br /><br />    private boolean calendarFieldOK(int calendarField) {<br />        switch (calendarField) {<br />            case Calendar.DATE:<br />            case Calendar.YEAR:<br />            case Calendar.MONTH:<br />                return true;<br />            default:<br />                return false;<br />        }<br />    }<br /><br />    /**<br />     * Creates an instance of SpinnerSimpleDateModel<br />     *<br />     * @param value         Initial date for the model<br />     * @param start         Minimum date for the model<br />     * @param end           Maximum date for the model<br />     * @param calendarField The interval desired for next and previous values.<br />     *                      The options are:<br />     *                      Calendar.DATE - Day of the month<br />     *                      Calendar.MONTH - Month<br />     *                      Calendar.YEAR - Year<br />     * @param dateFormat    A format specified by an instance of SimpleDateFormat<br />     */<br />    public SpinnerSimpleDateModel(Date value, Comparable start, Comparable end, <br />int calendarField, SimpleDateFormat dateFormat) {<br />        this.dateFormat = dateFormat;<br />        if (value == null) {<br />            throw new IllegalArgumentException("value is null");<br />        }<br />        if (!calendarFieldOK(calendarField)) {<br />            throw new IllegalArgumentException("invalid calendarField");<br />        }<br />        if ( !(((start == null) || (start.compareTo(value) &amp; lt;=0))&amp;&amp;<br />        ((end == null) || (end.compareTo(value) &amp; gt;=0)))){<br />            throw new IllegalArgumentException("(start &lt;= value &lt;= end) is false");<br />        }<br />        this.value = value;<br />        this.start = start;<br />        this.end = end;<br />        this.calendarField = calendarField;<br />    }<br /><br />    @Override<br />    public void setStart(Comparable start) {<br />        if ((start == null) ? (this.start != null) : !start.equals(this.start)) {<br />            this.start = start;<br />            fireStateChanged();<br />        }<br />    }<br /><br />    @Override<br />    public void setEnd(Comparable end) {<br />        if ((end == null) ? (this.end != null) : !end.equals(this.end)) {<br />            this.end = end;<br />            fireStateChanged();<br />        }<br />    }<br /><br />    @Override<br />    public void setCalendarField(int calendarField) {<br />        if (!calendarFieldOK(calendarField)) {<br />            throw new IllegalArgumentException("invalid calendarField");<br />        }<br />        if (calendarField != this.calendarField) {<br />            this.calendarField = calendarField;<br />            fireStateChanged();<br />        }<br />    }<br /><br />    @Override<br />    public Comparable getEnd() {<br />        return end;<br />    }<br /><br />    @Override<br />    public Object getNextValue() {<br />        Calendar cal = Calendar.getInstance();<br />        cal.setTime(value);<br />        cal.add(calendarField, 1);<br />        Date next = cal.getTime();<br />        return (end == null) || (end.compareTo(next) &amp; gt;=0)?next:<br />        null;<br />    }<br /><br />    @Override<br />    public Object getPreviousValue() {<br />        Calendar cal = Calendar.getInstance();<br />        cal.setTime(value);<br />        cal.add(calendarField, -1);<br />        Date prev = cal.getTime();<br />        return ((start == null) || (start.compareTo((prev)) &lt;= 0)) ? prev : null;<br />    }<br /><br />    @Override<br />    public Object getValue() {<br />        return value;<br />    }<br /><br />    @Override<br />    public void setValue(Object value) {<br />        if (value == null) {<br />            throw new NullPointerException("Date is null!");<br />        } else {<br />            if ((value instanceof String) &amp;&amp; ((String) value).matches("[0-9]+[/][0-9]+[/][0-9]+")) {<br />                String date = ((String) value);<br />                int day = Integer.parseInt(date.substring(0, 2));<br />                int month = Integer.parseInt(date.substring(3, 5));<br />                int year = Integer.parseInt(date.substring(6));<br />                Calendar cal = Calendar.getInstance();<br />                //Month-1 because is zero-based<br />                cal.set(year, month - 1, day);<br />                this.value = cal.getTime();<br />            }<br />            if (value instanceof Date) {<br />                if (!dateFormat.format((Date) value).equals(dateFormat.format(this.value))) {<br />                    String temp = dateFormat.format((Date) value);<br />                    this.setValue(temp);<br />                    fireStateChanged();<br />                }<br />            }<br />        }<br /><br />    }<br />}</pre>Now the model can be used for any JSpinner. To create an instance for this class, the following will work:  <code>SpinnerSimpleDateModel spinnerModel = new SpinnerSimpleDateModel(new Date(), null, null, Calendar.DATE, new SimpleDateFormat("dd/MM/yyyy"));</code> Then, set the editor of the <code>JSpinner</code> object to show the same format specified for the <code>SpinnerSimpleDateModel</code> object like the following: <pre>JSpinner spinner1 = new javax.swing.JSpinner();<br />spinner1.setModel(spinnerModel);<br />spinner1.setEditor(new javax.swing.JSpinner.DateEditor(spinner1, "dd/MM/yyyy"));</pre>Hope someone finds this useful. An advantage of using this technique is to manipulate date formats as you wish regardless of the OS or region.